#include "platform.h"
#include "peripheral.h"

using audio::Audio_Driver;

int main() {
	init_platform();

	UART uart{ UART::instance() };
	Audio_Driver audio{ Audio_Driver::instance()};
	Rotary_enc Rot_enc{ Rotary_enc::instance() };

	u8 ps_=0;
	u8 CS_=0;
	XGpio sw0;

	XGpio_Initialize(&sw0, XPAR_AXI_GPIO_1_DEVICE_ID);
	XGpio_SetDataDirection(&sw0, 2, ED_MAX_);
    while (1) {
    	CS_ = XGpio_DiscreteRead(&sw0, 2);
    	xil_printf("switch value%u\r\n",CS_);
    	if(ps_ != CS_){
    		if(CS_){
    			xil_printf("switch on\r\n");
    		}else{
    			xil_printf("switch off\r\n");
    		}

    	}
    	ps_ = CS_;
    	usleep(10000);
    }
    cleanup_platform();
    return 0;
}


